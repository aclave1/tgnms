# scan_service - Wireless Radio Scan Analysis + Storage
`scan_service` is a micro-service built on top of `tglib` that is responsible
for the collection and analysis of wireless radio scan data from Terragraph
networks.

## Architecture
The entry point to `scan_service` is an event handler that consumes messages
from Kafka and performs actions based on the message contents. The service
listens to the following Kafka topics:

- `events`: a stream of network events generated from many places within the
Terragraph ecosystem. `scan_service` performs actions on the `SCAN_COMPLETED`
event. This event is generated when a network finishes running a series of 
scans. `scan_service` performs analysis of the newly completed scans when it 
receives this event.

- `scan_results`: a stream of wireless scan data generated by running scans
between nodes, which contain information about signal strength, interference,
etc. This stream only contains one type of message, `ScanResultEventWrapper`,
which contains the results from scans that have finished on a network.
`scan_service` processes and stores this data inside of its own internally
managed scan database.

## Storage
The service stores scan data and analysis results inside of a MySQL database.
Each table it interacts with is defined by a file in `scan_service/models`.
The tables are defined as follows:

- `tx_scan_response`: Each row in this table represents the response from the
initiator node in a scan. It contains parameters used in the scan it ran and
metadata about the group of scans it ran in.

- `rx_scan_response`: Each row in this table represents the response from a
responder node in a scan. It contains data about the the signals it listened
to as well as the unique id of the `tx_scan_response` it is associated with.

- `scan_response_rate`: Each row in this table contains analysis data about
the response rate and error rate for a scan group (a series of scans of the
same type which were triggered from the same scheduling event).
